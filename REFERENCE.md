# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`crypto_policy`](#crypto_policy): Configure the system crypto policy settings
* [`crypto_policy::install`](#crypto_policy--install): Manage the installation of the crypto policy package(s)
* [`crypto_policy::update`](#crypto_policy--update): Helper class for triggering a run of update-crypto-policies

### Defined types

* [`crypto_policy::subpolicy`](#crypto_policy--subpolicy): Allows for management of crypto policy subpolicies. The content will not
have any validation performed on it, so the user is responsible for ensuring
the content is valid.

## Classes

### <a name="crypto_policy"></a>`crypto_policy`

Configure the system crypto policy settings

#### Examples

##### Using custom subpolicies in hiera

```puppet
crypto_policy::custom_subpolicies:
  MY_CUSTOM_SUBPOLICY:
    content: |
      # This is my custom subpolicy
      algorithm = MY_CUSTOM_ALGO
      key_size = 4096
    ensure: present
```

#### Parameters

The following parameters are available in the `crypto_policy` class:

* [`ensure`](#-crypto_policy--ensure)
* [`subpolicies`](#-crypto_policy--subpolicies)
* [`custom_subpolicies`](#-crypto_policy--custom_subpolicies)
* [`validate_policy`](#-crypto_policy--validate_policy)
* [`force_fips_override`](#-crypto_policy--force_fips_override)
* [`manage_installation`](#-crypto_policy--manage_installation)

##### <a name="-crypto_policy--ensure"></a>`ensure`

Data type: `String`

The global system crypto policy to enforce (DEFAULT, FIPS, etc). You may specify subpolicies here,
however, it is recommended to use the `subpolicies` parameter for clarity or specify your own
in `custom_subpolicies`.

* Will be checked against `$facts['crypto_policy_state']['global_policies_available']`
  and `$facts['crypto_policy_state']['sub_policies_available']`for validity

Default value: `$facts['fips_enabled'] ? { true => 'FIPS', default => $facts['crypto_policy_state']['global_policy']`

##### <a name="-crypto_policy--subpolicies"></a>`subpolicies`

Data type: `Array[String]`

An array of subpolicy names to apply in addition to the main policy specified
in the `ensure` parameter. These will be in addition to any custom_subpolicies specified.

Default value: `[]`

##### <a name="-crypto_policy--custom_subpolicies"></a>`custom_subpolicies`

Data type: `Hash`

A hash of custom subpolicy names to content that will be created in
`/usr/share/crypto-policies/policies/modules/` prior to applying the
selected policy. This allows users to create and apply their own
subpolicies.

Default value: `{}`

##### <a name="-crypto_policy--validate_policy"></a>`validate_policy`

Data type: `Boolean`

Disables validation of the `$ensure` parameter prior to application

Default value: `true`

##### <a name="-crypto_policy--force_fips_override"></a>`force_fips_override`

Data type: `Boolean`

Set this to indicate that you wish to force the system into the mode
specified by `$ensure` even if the system is in FIPS mode

* WARNING: This may break all crypto on your system

Default value: `false`

##### <a name="-crypto_policy--manage_installation"></a>`manage_installation`

Data type: `Boolean`

Enables management of the system installation via the `crypto_policy::install` class

Default value: `true`

### <a name="crypto_policy--install"></a>`crypto_policy::install`

Manage the installation of the crypto policy package(s)

#### Parameters

The following parameters are available in the `crypto_policy::install` class:

* [`packages`](#-crypto_policy--install--packages)
* [`package_ensure`](#-crypto_policy--install--package_ensure)

##### <a name="-crypto_policy--install--packages"></a>`packages`

Data type: `Array[String[1]]`

The list of packages to manage for this capability

Default value: `['crypto-policies', 'crypto-policies-scripts']`

##### <a name="-crypto_policy--install--package_ensure"></a>`package_ensure`

Data type: `String[1]`

The 'ensure' parameter for `$packages`

* NOTE: There are issues with `crypto-policies < 20190000` which may render
  a FIPS system inaccessible.

Default value: `'latest'`

### <a name="crypto_policy--update"></a>`crypto_policy::update`

This is deliberately not kept private in case other classes need to trigger
an update but do not wish to include full management

#### Parameters

The following parameters are available in the `crypto_policy::update` class:

* [`command`](#-crypto_policy--update--command)

##### <a name="-crypto_policy--update--command"></a>`command`

Data type: `Stdlib::Absolutepath`

The path to the command to be executed

Default value: `"/usr/bin/update-crypto-policies --set ${crypto_policy::_ensure}"`

## Defined types

### <a name="crypto_policy--subpolicy"></a>`crypto_policy::subpolicy`

Allows for management of crypto policy subpolicies. The content will not
have any validation performed on it, so the user is responsible for ensuring
the content is valid.

#### Parameters

The following parameters are available in the `crypto_policy::subpolicy` defined type:

* [`subpolicy_name`](#-crypto_policy--subpolicy--subpolicy_name)
* [`content`](#-crypto_policy--subpolicy--content)
* [`ensure`](#-crypto_policy--subpolicy--ensure)

##### <a name="-crypto_policy--subpolicy--subpolicy_name"></a>`subpolicy_name`

Data type: `String`

The name of the new subpolicy

Default value: `$name`

##### <a name="-crypto_policy--subpolicy--content"></a>`content`

Data type: `Optional[String]`

The content of the new subpolicy

Default value: `undef`

##### <a name="-crypto_policy--subpolicy--ensure"></a>`ensure`

Data type: `Variant[Boolean,Enum['absent','present']]`

Whether the subpolicy should (true) exist or not (false / absent)

Default value: `true`

